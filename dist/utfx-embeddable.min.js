/*
 utfx (c) 2014 Daniel Wirtz <dcode@dcode.io>
 Released under the Apache License, Version 2.0
 see: https://github.com/dcodeIO/utfx for details
*/
var utfx=function(n){function l(){return null}function g(){}function h(a){return 128>a?1:2048>a?2:65536>a?3:4}function m(a){if("number"!==typeof a||a!==a)throw TypeError("Illegal code point: "+a);if(0>a||1114111<a)throw RangeError("Illegal code point: "+a);}var f={TruncatedError:function(a){if(!(this instanceof f.TruncatedError))return new f.TruncatedError(a);Error.call(this);this.name="TruncatedError";this.message=a.join(", ");this.bytes=a}};f.TruncatedError.prototype=Error();f.encodeUTF8=function(a,
d,c){var b=null;"number"===typeof a&&(b=a,a=l);if(c)c=g;else{if("function"!==typeof a||"function"!==typeof d)throw TypeError("Illegal arguments: "+typeof a+", "+typeof d);c=function(a){if(0>a||1114111<a)throw RangeError("Illegal code point: "+a);}}for(;null!==b||null!==(b=a());)c(b),128>b?d(b&2033):(2048>b?d(b>>6&31|192):(65536>b?d(b>>12&15|224):(d(b>>18&7|240),d(b>>12&63|128)),d(b>>6&63|128)),d(b&63|128)),b=null};f.decodeUTF8=function(a,d,c){if(!c&&("function"!==typeof a||"function"!==typeof d))throw TypeError("Illegal arguments: "+
typeof a+", "+typeof d);for(var b,e,k,g=function(a){throw f.TruncatedError(a.slice(0,a.indexOf(null)));};null!==(c=a());)if(0===(c&128))d(c);else if(192===(c&224))null===(b=a())&&g([c,b]),d((c&31)<<6|b&63);else if(224===(c&240))null!==(b=a())&&null!==(e=a())||g([c,b,e]),d((c&15)<<12|(b&63)<<6|e&63);else if(240===(c&248))null!==(b=a())&&null!==(e=a())&&null!==(k=a())||g([c,b,e,k]),d((c&7)<<18|(b&63)<<12|(e&63)<<6|k&63);else throw RangeError("Illegal starting byte: "+c);};f.UTF16toUTF8=function(a,d,
c){if(c)c=g;else{if("function"!==typeof a||"function"!==typeof d)throw TypeError("Illegal arguments: "+typeof a+", "+typeof d);c=function(a){if("number"!==typeof a||a!==a)throw TypeError("Illegal char code: "+a);if(0>a||65535<a)throw RangeError("Illegal char code: "+b);}}for(var b,e=null;null!==(b=null!==e?e:a());){c(b);if(55296<=b&&57343>=b&&null!==(e=a())&&(c(e),56320<=e&&57343>=e)){d(1024*(b-55296)+e-56320+65536);e=null;continue}d(b)}null!==e&&d(e)};f.UTF8toUTF16=function(a,d,c){var b=null;"number"===
typeof a&&(b=a,a=l);if(c)c=g;else{if("function"!==typeof a||"function"!==typeof d)throw TypeError("Illegal arguments: "+typeof a+", "+typeof d);c=function(a){if("number"!==typeof a||a!==a)throw TypeError("Illegal code point: "+a);if(0>a||1114111<a)throw RangeError("Illegal code point: "+a);}}for(;null!==b||null!==(b=a());)c(b),65535>=b?d(b):(b-=65536,d((b>>10)+55296),d(b%1024+56320)),b=null};f.encodeUTF16toUTF8=function(a,d,c){if(!c&&"function"!==typeof d)throw TypeError("Illegal arguments: "+typeof a+
", "+typeof d);f.UTF16toUTF8(a,function(a){f.encodeUTF8(a,d,c)},c)};f.decodeUTF8toUTF16=function(a,d,c){if("function"!==typeof d)throw TypeError("Illegal arguments: "+typeof a+", "+typeof d);f.decodeUTF8(a,function(a){f.UTF8toUTF16(a,d,c)},c)};f.calculateUTF8=function(a,d){if("number"===typeof a)return h(a);var c;if(d)c=g;else{if(!d&&"function"!==typeof a)throw TypeError("Illegal arguments: "+typeof a);c=m}for(var b,e=0;null!==(b=a());)c(b),e+=h(b);return e};f.calculateUTF16asUTF8=function(a,d){var c=
0;f.UTF16toUTF8(a,function(a){c+=h(a)},d);return c};return f}(String);
